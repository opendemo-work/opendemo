# NGINX Ingress Controller 生产部署配置
apiVersion: v1
kind: Namespace
metadata:
  name: ingress-system
---
# 生产级ConfigMap配置
apiVersion: v1
kind: ConfigMap
metadata:
  name: nginx-configuration
  namespace: ingress-system
data:
  # 基础性能配置
  use-forwarded-headers: "true"
  compute-full-forwarded-for: "true"
  proxy-real-ip-cidr: "0.0.0.0/0"
  
  # 连接优化
  keep-alive: "120"
  keep-alive-requests: "10000"
  proxy-connect-timeout: "10"
  proxy-send-timeout: "60"
  proxy-read-timeout: "60"
  
  # 缓存配置
  proxy-buffering: "on"
  proxy-buffer-size: "4k"
  proxy-buffers-number: "8"
  proxy-busy-buffers-size: "8k"
  
  # 安全配置
  ssl-protocols: "TLSv1.2 TLSv1.3"
  ssl-ciphers: "ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384"
  ssl-prefer-server-ciphers: "false"
  
  # 日志配置
  log-format-upstream: '$remote_addr - $remote_user [$time_local] "$request" $status $body_bytes_sent "$http_referer" "$http_user_agent" $request_length $request_time [$proxy_upstream_name] $upstream_addr $upstream_response_length $upstream_response_time $upstream_status $req_id'
  
  # 自定义错误页面
  custom-http-errors: "404,500,502,503,504"
  
  # 启用压缩
  enable-brotli: "true"
  brotli-level: "6"
  brotli-types: "text/html text/css application/json application/javascript"
---
# TCP服务配置示例
apiVersion: v1
kind: ConfigMap
metadata:
  name: tcp-services
  namespace: ingress-system
data:
  9000: "default/my-tcp-service:9000"
---
# UDP服务配置示例
apiVersion: v1
kind: ConfigMap
metadata:
  name: udp-services
  namespace: ingress-system
data:
  53: "kube-system/kube-dns:53"